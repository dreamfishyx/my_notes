##### 静态ip

1. 使用 `docker network create` 命令创建一个自定义网络，并通过参数 `--subnet` 指定子网范围。

2. 通过 `docker run --network <network> --ip <static_ip>` 为容器分配静态 ip 地址。

   ```bash
   docker network create redis-net --subnet 172.20.0.0/24
   
   docker run \
   -dp 6379:6379 \
   --name redis-master\
   --network redis-network \
   --ip 172.20.0.2 \
   redis
   ```

3. 关于子网范围的补充:

   1. 网范围格式为 `<网络地址>/<子网掩码位数>`,其中子网掩码位数决定了子网的大小。位数越大，子网越小；位数越小，子网越大。

      > - 对于 172.20.0.0 这样一个 ip 地址，其实每个数字都是 8 位二进制组成。
      > - 对于 `172.20.0.0/24`，子网掩码是 `/24`，这意味着前 24 位是网络部分，后 8 位是主机部分。
      > - `/24` 表示子网掩码的前 24 位是 `1`，后 8 位是 `0`,用点分十进制表示法，`/24` 对应的子网掩码是 `255.255.255.0`。

   2. 常见的子网掩码位数及其对应的 IP 地址数量：

      - `/24`：256 个 IP 地址（如 `172.20.0.0/24`，可用 IP 范围为 `172.20.0.1` 到 `172.20.0.254`）。

      - `/16`：65536 个 IP 地址（如 `172.20.0.0/16`，可用 IP 范围为 `172.20.0.1` 到 `172.20.255.254`）。

      - `/8`：16777216 个 IP 地址（如 `10.0.0.0/8`，可用 IP 范围为 `10.0.0.1` 到 `10.255.255.254`）。
   
   3. 可用的私有 IP 地址范围:
   
      1. (大型)10.0.0.0/8:
         - 范围:`10.0.0.0` 到 `10.255.255.255`。
         - 子网掩码位数：`/8` 到 `/30`。
      2. (中型)172.16.0.0/12
         - 范围:`172.16.0.0` 到 `172.31.255.255`。
         - 子网掩码位数：`/12` 到 `/30`。
      3. (小型)192.168.0.0/16
         - 范围:`192.168.0.0` 到 `192.168.255.255`。
         - 子网掩码位数:`/16` 到 `/30`。
   
   4. 子网范围的选择建议:
   
      1. 根据容器数量选择合适的子网范围。如果只有少量容器，使用 `/24` 子网即可。如果需要支持大量容器，使用 `/16` 或 `/8` 子网。
      2. 如果需要多个隔离的网络，可以为每个网络分配不同的子网范围。
      3. 确保子网范围不与宿主机的网络或其他 Docker 网络冲突。






##### 访问主机

1. 使用 `host` 网络模式,如果容器使用 `--network host` 启动，容器会直接使用宿主机的网络栈。此时，容器内的 localhost 或 127.0.0.1 就是宿主机的 IP 地址。
2. 使用 `bridge` 网络模式(默认模式),如果容器使用默认的 bridge 网络模式，容器会通过 Docker 的虚拟网络与宿主机通信,容器中可以通过 `host.docker.internal` 或 `172.17.0.1` 访问宿主机。
3. 使用自定义 Docker 网络:如果容器加入了自定义的 Docker 网络，宿主机的 IP 地址可以通过该网络的网关地址访问。查看网关`docker network inspect <network>`。
4. 通过 `--add-host` 手动指定主机ip：如果宿主机有固定的 IP 地址，可以通过 `--add-host` 参数将宿主机的 IP 地址映射到容器内的一个主机名，例如`docker run --add-host local_host:192.168.1.100 my-container`。