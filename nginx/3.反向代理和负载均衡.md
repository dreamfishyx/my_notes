#### 虚拟主机配置

##### 常用配置

1. nginx 中使用 serve 配置虚拟主机:
   1. listen ：指定 Nginx 监听的端口。
   2. server_name ：指定虚拟主机的域名，可以用空格分隔多个域名。
   3. root ：定义网站的根目录 (也可以在 location  配置) 。
   4. index ：指定默认的首页文件 (也可以在 location  配置) 。
   5. location ：用于定义请求的匹配规则和处理方式 (重点) 。
   6. try_files ：尝试查找文件，如果找不到则返回404错误 (也可以在 location  配置) 。
   7. error_page ：自定义错误页面 (也可以在 location  配置) 。
2. listen 和 server_name 形成的集合体，需要有唯一性，不然就会出问题。





##### server_name 匹配

1. server_name 可以配置多个，中间以空格=分割即可。

2. 对于 server_name ,存在多种匹配规则：

   1. 完全匹配: 如果请求的主机名完全与 server_name 中的某个条目匹配，Nginx 将选择该 server 块处理请求。
   2. 通配符匹配: 可以使用 `*`通配符进行匹配
      - 在前面使用 `*`(如 `*.example.com` )表示匹配该域名下的所有子域名。
      - 在后面使用 `*`(如 `example.*` )表示匹配所有后缀的 example 域名。
   3. 正则表达式匹配:
      - 使用 `~` 符号来定义正则表达式。例如，`server_name ~^www\.(.*)$;` 可以匹配以 `www.` 开头的任意域名。

3.  server_name 的多种匹配规则存在一个匹配优先级:

   1. 完全匹配(最高优先级): 完全匹配的 server_name 将优先被选中。

   2. 通配符匹配：

      1. 以 `*` 开头的通配符(如 `*.example.com` )的优先级高于以 `*` 结尾的通配符(如 `example.*` )。
      2. 当有多个通配符匹配时，按照它们的声明顺序来决定优先级。

   3. 正则表达式匹配(最低优先级)：

      1. 在上述匹配未命中但是正则匹配命中时，正则表达式匹配的 server 块将被选中。
      2. 在正则匹配选中的前提下，当存在多个正则表达式匹配时，Nginx 会根据定义的顺序选择第一个匹配的 server 块。

      > 实际上这里的水还是挺深的，还存在默认匹配的情况

5. 关于默认
6. 不妨具体测试一下:



---



#### 反向代理

##### 反向代理与正向代理

